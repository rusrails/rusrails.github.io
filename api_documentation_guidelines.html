<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
  <head>
    <meta charset="utf-8">
<meta content="Ruby on Rails, Ruby, Rails, Rails 3, Rails 4, Rails 5, Rails 6, Rails 6.0, Rails 6.1, Rails 7.0, Rails 7.1 руководство, начинающим, самоучитель, manual, мануал, справочник, учебник, примеры, Руби, рельсы" name="keywords"/>
<meta content="Ruby on Rails руководства, учебники, статьи на русском языке" name="description"/>
<meta content="website" property="og:type"/>
<meta content="Rusrails: Рекомендации по документированию API" property="og:title"/>
<meta content="Ruby on Rails руководства, учебники, статьи на русском языке" property="og:description"/>
<meta content="http://localhost:3000/api_documentation_guidelines" property="og:url"/>
<meta content="http://rusrails.ru/assets/rusrails.png" property="og:image"/>
    <title>
      Rusrails: Рекомендации по документированию API
    </title>
    <link rel="stylesheet" href="/assets/application-f9dfa6ce7fa871006d478e422639671663284ddaa3126cf81ddfe371ac3533c4.css" />
  </head>
  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="brand" href="/"></a>
          <ul class="nav pull-right top-menu">
            <li>
              <a href="/">Главная</a>
            </li>
            <li class="dropdown">
              <a class="index-popover" href="#">
                Содержание
                <b class="caret"></b>
</a>              <div class="index-popover-content hide">
                  <ul><li><p><strong>С чего начать?</strong></p><ul><li><a href="/getting-started">Rails для начинающих</a>
</li></ul></li><li><p><strong>Модели</strong></p><ul><li><a href="/active-record-basics">Основы Active Record</a>
</li><li><a href="/active-record-migrations">Миграции Active Record</a>
</li><li><a href="/active-record-validations">Валидации Active Record</a>
</li><li><a href="/active-record-callbacks">Колбэки Active Record</a>
</li><li><a href="/active-record-associations">Связи (ассоциации) Active Record</a>
</li><li><a href="/active-record-querying">Интерфейс запросов Active Record</a>
</li><li><a href="/active-model-basics">Основы Active Model</a>
</li></ul></li><li><p><strong>Вью</strong></p><ul><li><a href="/action-view-overview">Обзор Action View</a>
</li><li><a href="/layouts-and-rendering">Макеты и рендеринг в Rails</a>
</li><li><a href="/action-view-helpers">Хелперы Action View</a>
</li><li><a href="/form-helpers">Хелперы форм в Action View</a>
</li></ul></li><li><p><strong>Контроллеры</strong></p><ul><li><a href="/action-controller-overview">Обзор Action Controller</a>
</li><li><a href="/routing">Роутинг в Rails</a>
</li></ul></li><li><p><strong>Другие компоненты</strong></p><ul><li><a href="/active-support-core-extensions">Расширения ядра Active Support</a>
</li><li><a href="/action-mailer-basics">Основы Action Mailer</a>
</li><li><a href="/action-mailbox-basics">Основы Action Mailbox</a>
</li><li><a href="/action-text-overview">Обзор Action Text</a>
</li><li><a href="/active_job_basics">Основы Active Job</a>
</li><li><a href="/active_storage_overview">Обзор Active Storage</a>
</li><li><a href="/action-cable-overview">Обзор Action Cable</a>
</li></ul></li><li><p><strong>Копаем глубже</strong></p><ul><li><a href="/i18n">API интернационализации Rails (I18n)</a>
</li><li><a href="/testing">Тестирование приложений на Rails</a>
</li><li><a href="/security">Безопасность приложений на Rails</a>
</li><li><a href="/error-reporting">Отчет об ошибках в приложениях Rails</a>
</li><li><a href="/debugging-rails-applications">Отладка приложений на Rails</a>
</li></ul></li></ul><p>next_column</p><ul><li><p><strong>Копаем глубже</strong></p><ul><li><a href="/configuring">Конфигурирование приложений на Rails</a>
</li><li><a href="/command-line">Командная строка Rails</a>
</li><li><a href="/asset-pipeline">Asset Pipeline</a>
</li><li><a href="/working-with-javascript-in-rails">Работа с JavaScript в Rails</a>
</li><li><a href="/initialization">Процесс инициализации в Rails</a>
</li><li><a href="/autoloading-and-reloading-constants">Автозагрузка и перезагрузка констант</a>
</li><li><a href="/caching-with-rails">Кэширование с Rails: Обзор</a>
</li><li><a href="/active-support-instrumentation">Инструментарий Active Support</a>
</li><li><a href="/api-app">Использование Rails для API-приложений</a>
</li><li><a href="/active-record-postgresql">Active Record для PostgreSQL</a>
</li><li><a href="/active-record-multiple-databases">Несколько баз данных с Active Record</a>
</li><li><a href="/active-record-encryption">Шифрование Active Record</a>
</li></ul></li><li><p><strong>Расширяем Rails</strong></p><ul><li><a href="/plugins">Основы создания плагинов Rails</a>
</li><li><a href="/rails-on-rack">Rails on Rack</a>
</li><li><a href="/generators">Создание и настройка генераторов и шаблонов Rails</a>
</li><li><a href="/engines">Engine для начинающих</a>
</li><li><a href="/threading_and_code_execution">Треды и выполнение кода в Rails</a>
</li><li><a href="/rails-application-templates">Шаблоны приложения Rails</a>
</li></ul></li><li><p><strong>Вносим вклад в Ruby on Rails</strong></p><ul><li><a href="/contributing_to_ruby_on_rails">Вносим вклад в Ruby on Rails</a>
</li><li><a href="/api_documentation_guidelines">Рекомендации по документированию API</a>
</li><li><a href="/ruby_on_rails_guides_guidelines">Рекомендации для руководств по Ruby on Rails</a>
</li><li><a href="/development_dependencies_install">Установка зависимостей для разработки</a>
</li><li><a href="/maintenance-policy">Политика поддержки (версий)</a>
</li></ul></li><li><p><strong>Заметки о релизах</strong></p><ul><li><a href="/upgrading-ruby-on-rails">Апгрейд Ruby on Rails</a>
</li><li><a href="/7_2_release_notes">Версия 7.2 - ?</a>
</li><li><a href="/7_1_release_notes">Версия 7.1 - Октябрь 2023</a>
</li><li><a href="/7_0_release_notes">Версия 7.0 - Декабрь 2021</a>
</li><li><a href="/6_1_release_notes">Версия 6.1 - Декабрь 2020</a>
</li><li><a href="/6_0_release_notes">Версия 6.0 - Август 2019</a>
</li></ul></li></ul>
              </div>
            </li>
            <li>
              <a href="/search">Поиск</a>
            </li>
            <li>
              <a target="blank" href="http://api.rusrails.ru">Ruby &amp; Rails API</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="content-wrapper">
      <div class="container-fluid">
        <div class="row-fluid">
          <div class="span3 pull-right">
            <div class="well social">
              <h4>Принимаем пожелания и пул-реквесты!</h4>
              <iframe allowtransparency="true" frameborder="0" height="30" src="http://ghbtns.com/github-btn.html?user=rusrails&repo=rusrails&type=watch&count=true&size=large" width="180"></iframe>
            </div>
              <div class="well menu">
                    <ul class="nav nav-list">
      <li>
        <h4>
          <a href="#rdoc">1. RDoc</a>
</h4>      </li>
      <li>
        <h4>
          <a href="#ssylki">2. Ссылки</a>
</h4>      </li>
      <li>
        <h4>
          <a href="#wording">3. Формулировки</a>
</h4>      </li>
      <li>
        <h4>
          <a href="#english">4. Английский язык</a>
</h4>      </li>
      <li>
        <h4>
          <a href="#oksfordskaya-zapyataya">5. Оксфордская запятая</a>
</h4>      </li>
      <li>
        <h4>
          <a href="#example-code">6. Пример кода</a>
</h4>      </li>
      <li>
        <h4>
          <a href="#bulevy-znacheniya">7. Булевы значения</a>
</h4>      </li>
      <li>
        <h4>
          <a href="#file-names">8. Имена файлов</a>
</h4>      </li>
      <li>
        <h4>
          <a href="#fonts">9. Шрифты</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#monoshirinnyy-shrift">9.1. Моноширинный шрифт</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#obychnyy-shrift">9.2. Обычный шрифт</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#opisatelnye-spiski">10. Описательные списки</a>
</h4>      </li>
      <li>
        <h4>
          <a href="#dinamicheski-sozdavaemye-metody">11. Динамически создаваемые методы</a>
</h4>      </li>
      <li>
        <h4>
          <a href="#vidimost-metodov">12. Видимость методов</a>
</h4>      </li>
      <li>
        <h4>
          <a href="#otnositelno-steka-rails">13. Относительно стека Rails</a>
</h4>      </li>
</ul>

              </div>
            <div class="well banner300 banner">
              <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<!-- sidebar rusrails -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:600px"
     data-ad-client="ca-pub-7764391801669990"
     data-ad-slot="6089520660"></ins>


<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

            </div>
          </div>
          <div class="span9 content pull-left">
            <div class="banner">
              <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  <!-- top rusrails -->
  <ins class="adsbygoogle"
       style="display:inline-block;width:980px;height:120px"
       data-ad-client="ca-pub-7764391801669990"
       data-ad-slot="4891989065"></ins>


<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

            </div>
              <h2 id='rekomendatsii-po-dokumentirovaniyu-api' class='inside_page_header'> Рекомендации по документированию API</h2><p>Это руководство документирует рекомендации к документации Ruby on Rails API.</p><p>После его прочтения, вы узнаете:</p><ul><li>Как писать эффективную прозу для целей документирования.
</li><li>Стилистические рекомендации для документирования различного кода на Ruby.
</li></ul>
<hr>
<h3 id='rdoc' class='inside_page_header'><a href="#rdoc">1.</a> RDoc</h3><p><a href="https://api.rubyonrails.org">Документация Rails API</a> генерируется с помощью <a href="https://ruby.github.io/rdoc/">RDoc</a>. Чтобы ее сгенерировать, убедитесь, что вы в корневой директории rails, запустите <code>bundle install</code> и выполните:</p><div class="code_container">
  <pre><code class="highlight console"><span class="gp">$</span><span class="w"> </span><span class="nb">bundle exec rake </span>rdoc
</code></pre>
</div>
<p>Итоговые файлы HTML будут в директории ./doc/rdoc.</p><div class="note"><p>Обратитесь к <a href="https://ruby.github.io/rdoc/RDoc/MarkupReference.html">справке по разметке RDoc</a> за помощью с синтаксисом.</p></div><h3 id='ssylki' class='inside_page_header'><a href="#ssylki">2.</a> Ссылки</h3><p>Документация Rails API не означает, что она будет просматриваемая на GitHub, и поэтому ссылки должны использовать разметку RDoc <a href="https://ruby.github.io/rdoc/RDoc/MarkupReference.html#class-RDoc::MarkupReference-label-Links"><code>link</code></a>, относительно текущего API.</p><p>Это потому, что разница между GitHub Markdown и сгенерированным RDoc в том, что это публикуется на <a href="https://api.rubyonrails.org">api.rubyonrails.org</a> и <a href="https://edgeapi.rubyonrails.org">edgeapi.rubyonrails.org</a>.</p><p>Например, мы используем <code>[link:classes/ActiveRecord/Base.html]</code> для создания ссылки на класс <code>ActiveRecord::Base</code>, генерируемой RDoc.</p><p>Это предпочтительней, чем абсолютный URL, такой как <code>[https://api.rubyonrails.org/classes/ActiveRecord/Base.html]</code>, который может перевести читателя на другую версию документации (например, edgeapi.rubyonrails.org).</p><h3 id='wording' class='inside_page_header'><a href="#wording">3.</a> Формулировки</h3><p>Пишите простые, декларативные предложения. Краткость — сестра таланта.</p><p>Пишите в настоящем времени: &quot;Returns a hash that...&quot;, а не &quot;Returned a hash that...&quot;, или &quot;Will return a hash that...&quot;.</p><p>Начинайте комментарии с большой буквы. Следуйте обычным правилам пунктуации:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="c1"># Declares an attribute reader backed by an internally-named</span>
<span class="c1"># instance variable.</span>
<span class="k">def</span> <span class="nf">attr_internal_reader</span><span class="p">(</span><span class="o">*</span><span class="n">attrs</span><span class="p">)</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre>
</div>
<p>Доносите до читателя правильный способ делать вещи, явно или неявно. Используйте идиомы, рекомендованные в последней версии. По необходимости перегруппируйте разделы, чтобы подчеркнуть предпочтительные подходы, и так далее. Документация должна быть моделью для лучшей практики и канонического, современного использования Rails.</p><p>Документация должна быть краткой, но всеобъемлющей. Исследуйте и документируйте крайние случаи. Что произойдет, если модуль анонимный? А что, если коллекция пустая? А если аргумент nil?</p><p>Правильные имена компонентов Rails имеют пробел между словами, например &quot;Active Support&quot;. <code>ActiveRecord</code> это модуль на Ruby, в то время как Active Record — это ORM. Вся документация Rails должна последовательно ссылаться на компоненты Rails по их правильным именам.</p><p>При ссылке на &quot;Rails application&quot;, в противоположность &quot;engine&quot; или &quot;plugin&quot;, всегда используйте &quot;application&quot;. Приложения Rails это не &quot;services&quot;, если вы не обсуждаете специально сервисно-ориентированную архитектуру.</p><p>Пишите имена правильно: Arel, minitest, RSpec, HTML, MySQL, JavaScript, ERB, Hotwire. Когда сомневаетесь, взгляните на какой-нибудь авторитетный источник, например, на их официальную документацию.</p><p>Используйте артикль &quot;an&quot; для &quot;SQL&quot;, как в &quot;an SQL statement&quot;. А также &quot;an SQLite database&quot;.</p><p>Предпочитайте формулировки, избегающие использование &quot;you&quot; и &quot;your&quot;. Например, вместо</p><div class="code_container">
  <pre><code class="highlight markdown">If you need to use <span class="sb">`return`</span> statements in your callbacks, it is recommended that you explicitly define them as methods.
</code></pre>
</div>
<p>используйте такую стилистику:</p><div class="code_container">
  <pre><code class="highlight markdown">If <span class="sb">`return`</span> is needed, it is recommended to explicitly define a method.
</code></pre>
</div>
<p>Тем не менее, при использовании местоимений для ссылки на гипотетическую личность, такую как &quot;a user with a session cookie&quot;, должны быть использованы гендерно нейтральные местоимения (they/their/them). Вместо:</p><ul><li>he или she... используйте they.
</li><li>him или her... используйте them.
</li><li>his или her... используйте their.
</li><li>his или hers... используйте theirs.
</li><li>himself или herself... используйте themselves.
</li></ul><h3 id='english' class='inside_page_header'><a href="#english">4.</a> Английский язык</h3><p>Пожалуйста, используйте американский английский (<em>color</em>, <em>center</em>, <em>modularize</em> и т.д.). Обратитесь к <a href="https://en.wikipedia.org/wiki/American_and_British_English_spelling_differences">списку различий в написании американских и британских английских слов</a>.</p><h3 id='oksfordskaya-zapyataya' class='inside_page_header'><a href="#oksfordskaya-zapyataya">5.</a> Оксфордская запятая</h3><p>Пожалуйста, используйте <a href="https://ru.wikipedia.org/wiki/%D0%A1%D0%B5%D1%80%D0%B8%D0%B9%D0%BD%D0%B0%D1%8F_%D0%B7%D0%B0%D0%BF%D1%8F%D1%82%D0%B0%D1%8F">оксфордскую запятую</a> (&quot;red, white, and blue&quot; вместо &quot;red, white and blue&quot;).</p><h3 id='example-code' class='inside_page_header'><a href="#example-code">6.</a> Пример кода</h3><p>Выбирайте осмысленные примеры, отображающие и покрывающие как основы, так и интересные моменты или подводные камни.</p><p>Используйте два пробела для отступа кусков кода — это означает, для целей разметки, два пробела с учетом левого отступа. Сами примеры должны следовать <a href="/contributing_to_ruby_on_rails#follow-the-coding-conventions">соглашениям по программированию Rails</a>.</p><p>Короткие документы не нуждаются в явной метке &quot;Examples&quot; для представления примеров кода; они идут следующим параграфом:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="c1"># Converts a collection of elements into a formatted string by</span>
<span class="c1"># calling +to_s+ on all elements and joining them.</span>
<span class="c1">#</span>
<span class="c1">#   Blog.all.to_fs # =&gt; "First PostSecond PostThird Post"</span>
</code></pre>
</div>
<p>С другой стороны, большие куски структурированной документации могут иметь отдельный раздел &quot;Examples&quot;:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="c1"># ==== Examples</span>
<span class="c1">#</span>
<span class="c1">#   Person.exists?(5)</span>
<span class="c1">#   Person.exists?('5')</span>
<span class="c1">#   Person.exists?(name: "David")</span>
<span class="c1">#   Person.exists?(['name LIKE ?', "%#{query}%"])</span>
</code></pre>
</div>
<p>Результаты выражений следуют за ними и представляются с помощью &quot;# =&gt; &quot;, выравненными по вертикали:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="c1"># For checking if a fixnum is even or odd.</span>
<span class="c1">#</span>
<span class="c1">#   1.even? # =&gt; false</span>
<span class="c1">#   1.odd?  # =&gt; true</span>
<span class="c1">#   2.even? # =&gt; true</span>
<span class="c1">#   2.odd?  # =&gt; false</span>
</code></pre>
</div>
<p>Если строчка слишком длинная, комментарий может быть помещен в следующей строчке:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="c1">#   label(:article, :title)</span>
<span class="c1">#   # =&gt; &lt;label for="article_title"&gt;Title&lt;/label&gt;</span>
<span class="c1">#</span>
<span class="c1">#   label(:article, :title, "A short title")</span>
<span class="c1">#   # =&gt; &lt;label for="article_title"&gt;A short title&lt;/label&gt;</span>
<span class="c1">#</span>
<span class="c1">#   label(:article, :title, "A short title", class: "title_label")</span>
<span class="c1">#   # =&gt; &lt;label for="article_title" class="title_label"&gt;A short title&lt;/label&gt;</span>
</code></pre>
</div>
<p>Избегайте использования любых выводящих методов, таких как <code>puts</code> или <code>p</code>, для этой цели.</p><p>С другой стороны, обычные комментарии не используют стрелку:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="c1">#   polymorphic_url(record)  # same as comment_url(record)</span>
</code></pre>
</div>
<h3 id='bulevy-znacheniya' class='inside_page_header'><a href="#bulevy-znacheniya">7.</a> Булевы значения</h3><p>В предикатах и флажках предпочитайте документировать булеву семантику над остальными значениями.</p><p>Когда &quot;true&quot; или &quot;false&quot; используются так, как определены в Ruby, используйте обычный шрифт. Синглтонам <code>true</code> и <code>false</code> необходим моноширинный шрифт. Пожалуйста, избегайте терминов, таких как &quot;truthy&quot;, Ruby определяет, что такое true и false в языке, и поэтому эти слова имеют техническое значение и не нуждаются в замене.</p><p>Как правило, не документируйте синглтоны, кроме случая, когда это абсолютно необходимо. Это предотвращает искусственные конструкции, наподобие <code>!!</code> или тернарного оператора, позволяет рефакторинг, и коду не нужно полагаться на точные значения, возвращаемыми в этой реализации.</p><p>Например, в:</p><div class="code_container">
  <pre><code class="highlight markdown"><span class="sb">`config.action_mailer.perform_deliveries`</span> specifies whether mail will actually be delivered and is true by default
</code></pre>
</div>
<p>пользователю не нужно знать, какое действительное значение по умолчанию у этого флажка, поэтому мы документируем только его булеву семантику.</p><p>Пример с предикатом:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="c1"># Returns true if the collection is empty.</span>
<span class="c1">#</span>
<span class="c1"># If the collection has been loaded</span>
<span class="c1"># it is equivalent to &lt;tt&gt;collection.size.zero?&lt;/tt&gt;. If the</span>
<span class="c1"># collection has not been loaded, it is equivalent to</span>
<span class="c1"># &lt;tt&gt;!collection.exists?&lt;/tt&gt;. If the collection has not already been</span>
<span class="c1"># loaded and you are going to fetch the records anyway it is better to</span>
<span class="c1"># check &lt;tt&gt;collection.length.zero?&lt;/tt&gt;.</span>
<span class="k">def</span> <span class="nf">empty?</span>
  <span class="k">if</span> <span class="n">loaded?</span>
    <span class="n">size</span><span class="p">.</span><span class="nf">zero?</span>
  <span class="k">else</span>
    <span class="vi">@target</span><span class="p">.</span><span class="nf">blank?</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">scope</span><span class="p">.</span><span class="nf">exists?</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>
<p>API осторожен, чтобы не обещать какое-либо конкретное значение, у метода есть семантика предиката, этого достаточно.</p><h3 id='file-names' class='inside_page_header'><a href="#file-names">8.</a> Имена файлов</h3><p>Как правило, используйте имена файлов относительно корня приложения:</p><div class="code_container">
  <pre><code class="highlight plaintext">config/routes.rb            # ДА
routes.rb                   # НЕТ
RAILS_ROOT/config/routes.rb # НЕТ
</code></pre>
</div>
<h3 id='fonts' class='inside_page_header'><a href="#fonts">9.</a> Шрифты</h3><h4 id='monoshirinnyy-shrift' class='inside_page_header'><a href="#monoshirinnyy-shrift">9.1.</a> Моноширинный шрифт</h4><p>Используйте моноширинные шрифты для:</p><ul><li>Констант, в частности имен классов и модулей.
</li><li>Имен методов.
</li><li>Литералов, таких как <code>nil</code>, <code>false</code>, <code>true</code>, <code>self</code>.
</li><li>Символов.
</li><li>Параметров методов.
</li><li>Имен файлов.
</li></ul><div class="code_container">
  <pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">Array</span>
  <span class="c1"># Calls +to_param+ on all its elements and joins the result with</span>
  <span class="c1"># slashes. This is used by +url_for+ in Action Pack.</span>
  <span class="k">def</span> <span class="nf">to_param</span>
    <span class="n">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">e</span><span class="o">|</span> <span class="n">e</span><span class="p">.</span><span class="nf">to_param</span> <span class="p">}.</span><span class="nf">join</span> <span class="s1">'/'</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>
<div class="warning"><p>Использование <code>+...+</code> для моноширинного шрифта работает только с простым содержимым, таким как обычные имена методов, символы, пути (с обратными слэшами) и так далее. Для всего остального используйте <code>&lt;tt&gt;...&lt;/tt&gt;</code>, особенно для имен классов или модулей в пространстве имен, как в <code>&lt;tt&gt;ActiveRecord::Base&lt;/tt&gt;</code>.</p></div><p>Можно быстро протестировать результат RDoc с помощью следующей команды:</p><div class="code_container">
  <pre><code class="highlight console"><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"+:to_param+"</span> | rdoc <span class="nt">--pipe</span>
<span class="gp">#</span><span class="w"> </span><span class="o">=&gt;</span> &lt;p&gt;&lt;code&gt;:to_param&lt;/code&gt;&lt;/p&gt;
</code></pre>
</div>
<h4 id='obychnyy-shrift' class='inside_page_header'><a href="#obychnyy-shrift">9.2.</a> Обычный шрифт</h4><p>Когда &quot;true&quot; и &quot;false&quot; это английские слова, в отличие от ключевых слов Ruby, используйте обычный шрифт:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="c1"># Runs all the validations within the specified context.</span>
<span class="c1"># Returns true if no errors are found, false otherwise.</span>
<span class="c1">#</span>
<span class="c1"># If the argument is false (default is +nil+), the context is</span>
<span class="c1"># set to &lt;tt&gt;:create&lt;/tt&gt; if &lt;tt&gt;new_record?&lt;/tt&gt; is true,</span>
<span class="c1"># and to &lt;tt&gt;:update&lt;/tt&gt; if it is not.</span>
<span class="c1">#</span>
<span class="c1"># Validations with no &lt;tt&gt;:on&lt;/tt&gt; option will run no</span>
<span class="c1"># matter the context. Validations with # some &lt;tt&gt;:on&lt;/tt&gt;</span>
<span class="c1"># option will only run in the specified context.</span>
<span class="k">def</span> <span class="nf">valid?</span><span class="p">(</span><span class="n">context</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre>
</div>
<h3 id='opisatelnye-spiski' class='inside_page_header'><a href="#opisatelnye-spiski">10.</a> Описательные списки</h3><p>В списках опций, параметров и т.д. используйте дефис между элементом и его описанием (читается лучше, чем двоеточие, так как опции обычно символы):</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="c1"># * &lt;tt&gt;:allow_nil&lt;/tt&gt; - Skip validation if attribute is +nil+.</span>
</code></pre>
</div>
<p>Описание начинается с заглавной буквы и заканчивается точкой — это стандартный английский.</p><p>Альтернативно, когда хотите предоставить дополнительные детали и примеры, используйте стиль раздела опций.</p><p>Хороший пример этого <a href="https://edgeapi.rubyonrails.org/classes/ActiveSupport/MessageEncryptor.html#method-i-encrypt_and_sign"><code>ActiveSupport::MessageEncryptor#encrypt_and_sign</code></a>.</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="c1"># ==== Options</span>
<span class="c1">#</span>
<span class="c1"># [+:expires_at+]</span>
<span class="c1">#   The datetime at which the message expires. After this datetime,</span>
<span class="c1">#   verification of the message will fail.</span>
<span class="c1">#</span>
<span class="c1">#     message = encryptor.encrypt_and_sign("hello", expires_at: Time.now.tomorrow)</span>
<span class="c1">#     encryptor.decrypt_and_verify(message) # =&gt; "hello"</span>
<span class="c1">#     # 24 hours later...</span>
<span class="c1">#     encryptor.decrypt_and_verify(message) # =&gt; nil</span>
</code></pre>
</div>
<h3 id='dinamicheski-sozdavaemye-metody' class='inside_page_header'><a href="#dinamicheski-sozdavaemye-metody">11.</a> Динамически создаваемые методы</h3><p>Методы, созданные с помощью <code>(module|class)_eval(STRING)</code>, имеют справа комментарий с экземпляром сгенерированного кода. Этот комментарий отделен двумя пробелами от шаблона:</p><p><img src='/assets/dynamic_method_class_eval-1e35052369fa0d155b591269e91a7812ed1135ffa8fadd66071ec0fd43956797.png' title='' alt='Комментарии кода (module|class)_eval(STRING)' class='img-polaroid' /></p><p>Если результирующие строчки получаются слишком длинными, скажем 200 символов и больше, поместите комментарий над вызовом:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="c1"># def self.find_by_login_and_activated(*args)</span>
<span class="c1">#   options = args.extract_options!</span>
<span class="c1">#   ...</span>
<span class="c1"># end</span>
<span class="nb">self</span><span class="p">.</span><span class="nf">class_eval</span> <span class="sx">%{
  def self.#{method_id}(*args)
    options = args.extract_options!
    ...
  end
}</span>
</code></pre>
</div>
<h3 id='vidimost-metodov' class='inside_page_header'><a href="#vidimost-metodov">12.</a> Видимость методов</h3><p>При написании документации для Rails, важно понимать различие между публичным пользовательским API и внутренним API.</p><p>Rails, как и многие библиотеки, использует ключевое слово private из Ruby для определения внутреннего API. Однако, публичный API следует немного отличающимся соглашениям. Вместо предположения, что все публичные методы разработаны для пользователя, Rails использует директиву <code>:nodoc:</code> для аннотирования таких методов как внутреннего API.</p><p>Это означает, что в Rails имеются методы с видимостью <code>public</code>, не предназначенные для пользователя.</p><p>Примером этого является <code>ActiveRecord::Core::ClassMethods#arel_table</code>:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="k">module</span> <span class="nn">ActiveRecord::Core::ClassMethods</span>
  <span class="k">def</span> <span class="nf">arel_table</span> <span class="c1"># :nodoc:</span>
    <span class="c1"># do some magic..</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>
<p>Если вы подумаете: &quot;этот метод выглядит публичным методом класса для <code>ActiveRecord::Core</code>&quot;, то будете правы. Но фактически, основная команда Rails не хочет, чтобы пользователи полагались на этот метод. Поэтому они пометили его как <code>:nodoc:</code>, и он убран из публичной документации. Обоснованием этого является необходимость позволить команде изменить эти методы в соответствии с их внутренними потребностями между релизами, по их усмотрению. Может измениться имя этого метода, или возвращаемое значение, или может исчезнуть весь этот класс; нет гарантии, и поэтому вы не должны зависеть от этого API в ваших плагинах или приложениях. В противном случае, есть риск, что приложение или гем сломаются при апгрейде до более нового релиза Rails.</p><p>В качестве контрибьютора важно думать, предназначен ли этот API для конечного пользователя. Команда Rails стремится не вносить какие-либо критические изменения в публичный API между релизами без прохождения полного цикла устаревания. Рекомендуется, чтобы вы помечали <code>:nodoc:</code> любые ваши внутренние методы/классы, за исключением тех, которые уже приватные (имеется в виду видимость), в этом случае они внутренние по умолчанию. Как только API стабилизируется, видимость может измениться, но изменение публичного API намного сложнее из-за обратной совместимости.</p><p>Классы или модули, помеченные <code>:nodoc:</code>, показывают, что все методы являются внутренним API, и никогда не должны использоваться непосредственно.</p><p>Итак, команда Rails использует <code>:nodoc:</code>, чтобы пометить публично видимые методы и классы для внутреннего использования; изменения видимости в API должны сначала тщательно рассматриваться и обсуждаться в пул-реквесте.</p><h3 id='otnositelno-steka-rails' class='inside_page_header'><a href="#otnositelno-steka-rails">13.</a> Относительно стека Rails</h3><p>При документировании частей Rails API важно помнить все кусочки, составляющие стек Rails.</p><p>Это означает, что поведение может измениться в зависимости от области видимости или контекста метода или класса, который вы пытаетесь документировать.</p><p>В различных местах имеется различное поведение, если принимать во внимание полный стек, одним из примеров является <code>ActionView::Helpers::AssetTagHelper#image_tag</code>:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="c1"># image_tag("icon.png")</span>
<span class="c1">#   # =&gt; &lt;img src="/assets/icon.png" /&gt;</span>
</code></pre>
</div>
<p>Хотя поведением по умолчанию для <code>#image_tag</code> является всегда возвращать <code>/images/icon.png</code>, учитывая полный стек Rails (включая Asset Pipeline), мы можем увидеть вышеуказанный результат.</p><p>Мы беспокоимся только о поведении при использовании полного стека Rails по умолчанию.</p><p>В этом случае мы хотим документировать поведение этого <em>фреймворка</em>, а не просто этого отдельного метода.</p><p>Если у вас есть вопрос, как команда Rails управляет определенными API, не стесняйтесь открыть тикет или послать патч в <a href="https://github.com/rails/rails/issues">трекер проблем</a>.</p>

            <div class="banner">
              <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

   <!-- bottom rusrails -->
   <ins class="adsbygoogle"
        style="display:inline-block;width:580px;height:400px"
        data-ad-client="ca-pub-7764391801669990"
        data-ad-slot="7566253867"></ins>


<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

            </div>
          </div>
        </div>
        <div class="row-fluid">
          <div class="span12" id="footer">
            <p>
              <a target="blank" href="https://github.com/rusrails/rusrails"><img src="/assets/github-7cc23602a5ac2465f14c19492358a5a67dc24636761cc723e4d621cea0c09225.png" /></a>
            </p>
            <p>
              <a href="https://creativecommons.org/licenses/by-sa/4.0/">Лицензия CC BY-SA 4.0</a>
              "Rails", "Ruby on Rails" и логотип Rails - торговые марки DHH
              <!-- Yandex.Metrika counter -->
<script>
  (function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter1006929 = new Ya.Metrika({id:1006929,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>

<noscript>
  <div>
    <img style="position:absolute; left:-9999px;" alt="" src="//mc.yandex.ru/watch/1006929" />
  </div>
</noscript>
<!-- /Yandex.Metrika counter -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-64955373-1', 'auto');
  ga('send', 'pageview');

  var trackOutboundLink = function(url) {
    ga('send', 'event', 'outbound', 'click', url, {
      'transport': 'beacon',
      'hitCallback': function(){ }
    });
  }
</script>

            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="to_top" style="display: block">
      <div class="to_top_panel"></div>
    </div>
    <script src="/assets/application-48ac5c5be8858f5558a99606c2d341f9fee482f22db6deee5def03837c505584.js"></script>
  </body>
</html>

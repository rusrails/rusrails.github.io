<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
  <head>
    <meta charset="utf-8">
<meta content="Ruby on Rails, Ruby, Rails, Rails 3, Rails 4, Rails 5, Rails 6, Rails 6.0, Rails 6.1, Rails 7.0, Rails 7.1 руководство, начинающим, самоучитель, manual, мануал, справочник, учебник, примеры, Руби, рельсы" name="keywords"/>
<meta content="Ruby on Rails руководства, учебники, статьи на русском языке" name="description"/>
<meta content="product" property="twitter:card"/>
<meta content="@rusrails" property="twitter:site"/>
<meta content="Rusrails: Заметки о релизе Ruby on Rails 6.1" property="twitter:title"/>
<meta content="Ruby on Rails руководства, учебники, статьи на русском языке" property="twitter:description"/>
<meta content="@rusrails" property="twitter:creator"/>
<meta content="http://rusrails.ru/assets/rusrails.png" property="twitter:image"/>
<meta content="website" property="og:type"/>
<meta content="Rusrails: Заметки о релизе Ruby on Rails 6.1" property="og:title"/>
<meta content="Ruby on Rails руководства, учебники, статьи на русском языке" property="og:description"/>
<meta content="http://localhost:3000/6_1_release_notes" property="og:url"/>
<meta content="http://rusrails.ru/assets/rusrails.png" property="og:image"/>
    <title>
      Rusrails: Заметки о релизе Ruby on Rails 6.1
    </title>
    <link rel="stylesheet" media="screen" href="/assets/application-f9dfa6ce7fa871006d478e422639671663284ddaa3126cf81ddfe371ac3533c4.css" />
  </head>
  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="brand" href="/"></a>
          <ul class="nav pull-right top-menu">
            <li>
              <a href="/">Главная</a>
            </li>
            <li class="dropdown">
              <a class="index-popover" href="#">
                Содержание
                <b class="caret"></b>
</a>              <div class="index-popover-content hide">
                  <ul><li><p><strong>С чего начать?</strong></p><ul><li><a href="/getting-started">Rails для начинающих</a>
</li></ul></li><li><p><strong>Модели</strong></p><ul><li><a href="/active-record-basics">Основы Active Record</a>
</li><li><a href="/active-record-migrations">Миграции Active Record</a>
</li><li><a href="/active-record-validations">Валидации Active Record</a>
</li><li><a href="/active-record-callbacks">Колбэки Active Record</a>
</li><li><a href="/active-record-associations">Связи (ассоциации) Active Record</a>
</li><li><a href="/active-record-querying">Интерфейс запросов Active Record</a>
</li><li><a href="/active-model-basics">Основы Active Model</a>
</li></ul></li><li><p><strong>Вью</strong></p><ul><li><a href="/action-view-overview">Обзор Action View</a>
</li><li><a href="/layouts-and-rendering">Макеты и рендеринг в Rails</a>
</li><li><a href="/action-view-helpers">Хелперы Action View</a>
</li><li><a href="/form-helpers">Хелперы форм в Action View</a>
</li></ul></li><li><p><strong>Контроллеры</strong></p><ul><li><a href="/action-controller-overview">Обзор Action Controller</a>
</li><li><a href="/routing">Роутинг в Rails</a>
</li></ul></li><li><p><strong>Другие компоненты</strong></p><ul><li><a href="/active-support-core-extensions">Расширения ядра Active Support</a>
</li><li><a href="/action-mailer-basics">Основы Action Mailer</a>
</li><li><a href="/action-mailbox-basics">Основы Action Mailbox</a>
</li><li><a href="/action-text-overview">Обзор Action Text</a>
</li><li><a href="/active_job_basics">Основы Active Job</a>
</li><li><a href="/active_storage_overview">Обзор Active Storage</a>
</li><li><a href="/action-cable-overview">Обзор Action Cable</a>
</li></ul></li><li><p><strong>Копаем глубже</strong></p><ul><li><a href="/i18n">API интернационализации Rails (I18n)</a>
</li><li><a href="/testing">Тестирование приложений на Rails</a>
</li><li><a href="/security">Безопасность приложений на Rails</a>
</li><li><a href="/error-reporting">Отчет об ошибках в приложениях Rails</a>
</li></ul></li></ul><p>next_column</p><ul><li><p><strong>Копаем глубже</strong></p><ul><li><a href="/debugging-rails-applications">Отладка приложений на Rails</a>
</li><li><a href="/configuring">Конфигурирование приложений на Rails</a>
</li><li><a href="/command-line">Командная строка Rails</a>
</li><li><a href="/asset-pipeline">Asset Pipeline</a>
</li><li><a href="/working-with-javascript-in-rails">Работа с JavaScript в Rails</a>
</li><li><a href="/initialization">Процесс инициализации в Rails</a>
</li><li><a href="/autoloading-and-reloading-constants">Автозагрузка и перезагрузка констант</a>
</li><li><a href="/classic-to-zeitwerk-howto">Как перейти с Classic на Zeitwerk</a>
</li><li><a href="/caching-with-rails">Кэширование с Rails: Обзор</a>
</li><li><a href="/active-support-instrumentation">Инструментарий Active Support</a>
</li><li><a href="/api-app">Использование Rails для API-приложений</a>
</li><li><a href="/active-record-postgresql">Active Record для PostgreSQL</a>
</li><li><a href="/active-record-multiple-databases">Несколько баз данных с Active Record</a>
</li><li><a href="/active-record-encryption">Шифрование Active Record</a>
</li></ul></li><li><p><strong>Расширяем Rails</strong></p><ul><li><a href="/plugins">Основы создания плагинов Rails</a>
</li><li><a href="/rails-on-rack">Rails on Rack</a>
</li><li><a href="/generators">Создание и настройка генераторов и шаблонов Rails</a>
</li><li><a href="/engines">Engine для начинающих</a>
</li><li><a href="/threading_and_code_execution">Треды и выполнение кода в Rails</a>
</li><li><a href="/rails-application-templates">Шаблоны приложения Rails</a>
</li></ul></li><li><p><strong>Вносим вклад в Ruby on Rails</strong></p><ul><li><a href="/contributing_to_ruby_on_rails">Вносим вклад в Ruby on Rails</a>
</li><li><a href="/api_documentation_guidelines">Рекомендации по документированию API</a>
</li><li><a href="/ruby_on_rails_guides_guidelines">Рекомендации для руководств по Ruby on Rails</a>
</li><li><a href="/development_dependencies_install">Установка зависимостей для разработки</a>
</li><li><a href="/maintenance-policy">Политика поддержки (версий)</a>
</li></ul></li><li><p><strong>Заметки о релизах</strong></p><ul><li><a href="/upgrading-ruby-on-rails">Апгрейд Ruby on Rails</a>
</li><li><a href="/7_1_release_notes">Версия 7.1 - ?</a>
</li><li><a href="/7_0_release_notes">Версия 7.0 - Декабрь 2021</a>
</li><li><a href="/6_1_release_notes">Версия 6.1 - Декабрь 2020</a>
</li><li><a href="/6_0_release_notes">Версия 6.0 - Август 2019</a>
</li></ul></li></ul>
              </div>
            </li>
            <li>
              <a href="/search">Поиск</a>
            </li>
            <li>
              <a target="blank" href="http://api.rusrails.ru">Ruby &amp; Rails API</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="content-wrapper">
      <div class="container-fluid">
        <div class="row-fluid">
          <div class="span3 pull-right">
            <div class="well social">
              <h4>Принимаем пожелания и пул-реквесты!</h4>
              <iframe allowtransparency="true" frameborder="0" height="30" src="http://ghbtns.com/github-btn.html?user=rusrails&repo=rusrails&type=watch&count=true&size=large" width="180"></iframe>
              <p></p>
              <a class="twitter-follow-button" data-lang="ru" href="https://twitter.com/rusrails"></a>
            </div>
              <div class="well menu">
                    <ul class="nav nav-list">
      <li>
        <h4>
          <a href="#apgreyd-do-rails-6-1">1. Апгрейд до Rails 6.1</a>
</h4>      </li>
      <li>
        <h4>
          <a href="#osnovnye-osobennosti">2. Основные особенности</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#pereklyucheniya-soedineniya-dlya-otdelnoy-bazy-dannyh">2.1. Переключения соединения для отдельной базы данных</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#gorizontalnyy-sharding">2.2. Горизонтальный шардинг</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#strict-loading-associations">2.3. Strict Loading Associations</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#delegirovannye-tipy">2.4. Делегированные типы</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#asinhronnoe-udalenie-svyazey">2.5. Асинхронное удаление связей</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#railties">3. Railties</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#udaleno">3.1. Удалено</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#ustarelo">3.2. Устарело</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#znachimye-izmeneniya">3.3. Значимые изменения</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#action-cable">4. Action Cable</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#udaleno2">4.1. Удалено</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#ustarelo2">4.2. Устарело</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#znachimye-izmeneniya2">4.3. Значимые изменения</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#action-pack">5. Action Pack</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#udaleno3">5.1. Удалено</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#ustarelo3">5.2. Устарело</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#znachimye-izmeneniya3">5.3. Значимые изменения</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#action-view">6. Action View</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#udaleno4">6.1. Удалено</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#ustarelo4">6.2. Устарело</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#znachimye-izmeneniya4">6.3. Значимые изменения</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#action-mailer">7. Action Mailer</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#udaleno5">7.1. Удалено</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#ustarelo5">7.2. Устарело</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#znachimye-izmeneniya5">7.3. Значимые изменения</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#active-record">8. Active Record</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#udaleno6">8.1. Удалено</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#ustarelo6">8.2. Устарело</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#znachimye-izmeneniya6">8.3. Значимые изменения</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#active-storage">9. Active Storage</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#udaleno7">9.1. Удалено</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#ustarelo7">9.2. Устарело</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#znachimye-izmeneniya7">9.3. Значимые изменения</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#active-model">10. Active Model</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#udaleno8">10.1. Удалено</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#ustarelo8">10.2. Устарело</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#znachimye-izmeneniya8">10.3. Значимые изменения</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#active-support">11. Active Support</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#udaleno9">11.1. Удалено</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#ustarelo9">11.2. Устарело</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#znachimye-izmeneniya9">11.3. Значимые изменения</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#active-job">12. Active Job</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#udaleno10">12.1. Удалено</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#ustarelo10">12.2. Устарело</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#znachimye-izmeneniya10">12.3. Значимые изменения</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#action-text">13. Action Text</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#udaleno11">13.1. Удалено</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#ustarelo11">13.2. Устарело</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#znachimye-izmeneniya11">13.3. Значимые изменения</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#action-mailbox">14. Action Mailbox</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#udaleno12">14.1. Удалено</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#ustarelo12">14.2. Устарело</a>
</h5>      </li>
      <li>
        <h5>
          <a href="#znachimye-izmeneniya12">14.3. Значимые изменения</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#ruby-on-rails-guides">15. Ruby on Rails Guides</a>
</h4>      </li>
      <li>
        <h5>
          <a href="#znachimye-izmeneniya13">15.1. Значимые изменения</a>
</h5>      </li>
      <li>
        <h4>
          <a href="#blagodarnosti">16. Благодарности</a>
</h4>      </li>
</ul>

              </div>
            <div class="well banner300 banner">
              <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<!-- sidebar rusrails -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:600px"
     data-ad-client="ca-pub-7764391801669990"
     data-ad-slot="6089520660"></ins>


<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

            </div>
          </div>
          <div class="span9 content pull-left">
            <div class="banner">
              <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  <!-- top rusrails -->
  <ins class="adsbygoogle"
       style="display:inline-block;width:980px;height:120px"
       data-ad-client="ca-pub-7764391801669990"
       data-ad-slot="4891989065"></ins>


<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

            </div>
              <h2 id='zametki-o-relize-ruby-on-rails-6-1' class='inside_page_header'> Заметки о релизе Ruby on Rails 6.1</h2><p>Ключевые новинки в Rails 6.1:</p><ul><li>Переключения соединения для отдельной базы данных
</li><li>Горизонтальный шардинг
</li><li>Строгая загрузка связей
</li><li>Делегированные типы
</li><li>Асинхронное удаление связей
</li></ul><p>Эти заметки о релизе покрывают только основные изменения. Чтобы узнать о других обновлениях, различных исправлениях программных ошибок и изменениях, обратитесь к логам изменений или к <a href="https://github.com/rails/rails/commits/6-1-stable">списку коммитов</a> в главном репозитории Rails на GitHub.</p>
<hr>
<h3 id='apgreyd-do-rails-6-1' class='inside_page_header'><a href="#apgreyd-do-rails-6-1">1.</a> Апгрейд до Rails 6.1</h3><p>Прежде чем апгрейднуть существующее приложение, было бы хорошо иметь перед этим покрытие тестами. Также, до попытки обновиться до Rails 6.1, необходимо сначала произвести апгрейд до Rails 6.0 и убедиться, что приложение все еще выполняется так, как нужно. Список вещей, которые нужно выполнить для апгрейда доступен в руководстве <a href="/upgrading-ruby-on-rails#upgrading-from-rails-6-0-to-rails-6-1">Апгрейд Ruby on Rails</a>.</p><h3 id='osnovnye-osobennosti' class='inside_page_header'><a href="#osnovnye-osobennosti">2.</a> Основные особенности</h3><h4 id='pereklyucheniya-soedineniya-dlya-otdelnoy-bazy-dannyh' class='inside_page_header'><a href="#pereklyucheniya-soedineniya-dlya-otdelnoy-bazy-dannyh">2.1.</a> Переключения соединения для отдельной базы данных</h4><p>Rails 6.1 предоставляет вам возможность <a href="https://github.com/rails/rails/pull/40370">переключать соединения для отдельной базы данных</a>. В 6.0, если вы переключались на роль <code>reading</code>, то все соединения с базами данных также переключались на читающую роль. Теперь в 6.1 при установленном <code>legacy_connection_handling</code> в <code>false</code> в конфигурации, Rails позволит переключать соединение для отдельной базы данных с помощью вызова <code>connected_to</code> на соответствующем абстрактном классе.</p><h4 id='gorizontalnyy-sharding' class='inside_page_header'><a href="#gorizontalnyy-sharding">2.2.</a> Горизонтальный шардинг</h4><p>Rails 6.0 предоставлял возможность функционального разделения (несколько разделов, разные схемы) вашей базы данных, но не был способен поддерживать горизонтальный шардинг (та же схема, несколько разделов). Rails не был способен поддерживать горизонтальный шардинг, так как модели в Active Record могли иметь только одно соединение на роль на класс. Теперь это исправлено и <a href="https://github.com/rails/rails/pull/38531">горизонтальный шардинг</a> доступен в Rails.</p><h4 id='strict-loading-associations' class='inside_page_header'><a href="#strict-loading-associations">2.3.</a> Strict Loading Associations</h4><p><a href="https://github.com/rails/rails/pull/37400">Строгая загрузка связей</a> позволяет убедиться, что все связи нетерпеливо загружены, что предотвратит дальнейшее выполнение при N+1.</p><h4 id='delegirovannye-tipy' class='inside_page_header'><a href="#delegirovannye-tipy">2.4.</a> Делегированные типы</h4><p><a href="https://github.com/rails/rails/pull/39341">Делегированные типы</a> это альтернатива наследованию с одной таблицей. Это помогает представлению иерархий классов, позволяя суперклассу быть конкретным классом, представленным собственной таблицей. У каждого подкласса есть собственная таблица для дополнительных атрибутов.</p><h4 id='asinhronnoe-udalenie-svyazey' class='inside_page_header'><a href="#asinhronnoe-udalenie-svyazey">2.5.</a> Асинхронное удаление связей</h4><p><a href="https://github.com/rails/rails/pull/40157">Асинхронное удаление связей</a> добавляет возможность приложение вызывать <code>destroy</code> на связях в фоновом задании. Это может помочь избежать таймаутов и других проблем с производительностью при удалении данных.</p><h3 id='railties' class='inside_page_header'><a href="#railties">3.</a> Railties</h3><p>За подробностями обратитесь к <a href="https://github.com/rails/rails/blob/6-1-stable/railties/CHANGELOG.md">Changelog</a>.</p><h4 id='udaleno' class='inside_page_header'><a href="#udaleno">3.1.</a> Удалено</h4><ul><li><p>  Удалены устаревшие задачи <code>rake notes</code>.</p></li><li><p>  Удалена устаревшая опция <code>connection</code> в команде <code>rails dbconsole</code>.</p></li><li><p>  Из <code>rails notes</code> удалена устаревшая поддержка переменной среды <code>SOURCE_ANNOTATION_DIRECTORIES</code> .</p></li><li><p>  Из команды rails server удален устаревший аргумент <code>server</code>.</p></li><li><p>  Удалена устаревшая поддержка использования переменной среды <code>HOST</code> для указания IP сервера.</p></li><li><p>  Удалены устаревшие задачи <code>rake dev:cache</code>.</p></li><li><p>  Удалены устаревшие задачи <code>rake routes</code>.</p></li><li><p>  Удалены устаревшие задачи <code>rake initializers</code>.</p></li></ul><h4 id='ustarelo' class='inside_page_header'><a href="#ustarelo">3.2.</a> Устарело</h4><h4 id='znachimye-izmeneniya' class='inside_page_header'><a href="#znachimye-izmeneniya">3.3.</a> Значимые изменения</h4><h3 id='action-cable' class='inside_page_header'><a href="#action-cable">4.</a> Action Cable</h3><p>За подробностями обратитесь к <a href="https://github.com/rails/rails/blob/6-1-stable/actioncable/CHANGELOG.md">Changelog</a>.</p><h4 id='udaleno2' class='inside_page_header'><a href="#udaleno2">4.1.</a> Удалено</h4><h4 id='ustarelo2' class='inside_page_header'><a href="#ustarelo2">4.2.</a> Устарело</h4><h4 id='znachimye-izmeneniya2' class='inside_page_header'><a href="#znachimye-izmeneniya2">4.3.</a> Значимые изменения</h4><h3 id='action-pack' class='inside_page_header'><a href="#action-pack">5.</a> Action Pack</h3><p>За подробностями обратитесь к <a href="https://github.com/rails/rails/blob/6-1-stable/actionpack/CHANGELOG.md">Changelog</a>.</p><h4 id='udaleno3' class='inside_page_header'><a href="#udaleno3">5.1.</a> Удалено</h4><ul><li><p>  Удален устаревший <code>ActionDispatch::Http::ParameterFilter</code>.</p></li><li><p>  Удален устаревший <code>force_ssl</code> на уровне контроллера.</p></li></ul><h4 id='ustarelo3' class='inside_page_header'><a href="#ustarelo3">5.2.</a> Устарело</h4><ul><li>  Устарел <code>config.action_dispatch.return_only_media_type_on_content_type</code>.
</li></ul><h4 id='znachimye-izmeneniya3' class='inside_page_header'><a href="#znachimye-izmeneniya3">5.3.</a> Значимые изменения</h4><ul><li>  Изменен <code>ActionDispatch::Response#content_type</code>, чтобы возвращался полный заголовок Content-Type.
</li></ul><h3 id='action-view' class='inside_page_header'><a href="#action-view">6.</a> Action View</h3><p>За подробностями обратитесь к <a href="https://github.com/rails/rails/blob/6-1-stable/actionview/CHANGELOG.md">Changelog</a>.</p><h4 id='udaleno4' class='inside_page_header'><a href="#udaleno4">6.1.</a> Удалено</h4><ul><li><p>  Удален устаревший <code>escape_whitelist</code> из <code>ActionView::Template::Handlers::ERB</code>.</p></li><li><p>  Удален устаревший <code>find_all_anywhere</code> из <code>ActionView::Resolver</code>.</p></li><li><p>  Удален устаревший <code>formats</code> из <code>ActionView::Template::HTML</code>.</p></li><li><p>  Удален устаревший <code>formats</code> из <code>ActionView::Template::RawFile</code>.</p></li><li><p>  Удален устаревший <code>formats</code> из <code>ActionView::Template::Text</code>.</p></li><li><p>  Удален устаревший <code>find_file</code> из <code>ActionView::PathSet</code>.</p></li><li><p>  Удален устаревший <code>rendered_format</code> из <code>ActionView::LookupContext</code>.</p></li><li><p>  Удален устаревший <code>find_file</code> из <code>ActionView::ViewPaths</code>.</p></li><li><p>  Удалена устаревшая поддержка передачи объекта, не являющегося <code>ActionView::LookupContext</code>, в качестве первого аргумента в <code>ActionView::Base#initialize</code>.</p></li><li><p>  Удален устаревший аргумент <code>format</code> в <code>ActionView::Base#initialize</code>.</p></li><li><p>  Удален устаревший <code>ActionView::Template#refresh</code>.</p></li><li><p>  Удален устаревший <code>ActionView::Template#original_encoding</code>.</p></li><li><p>  Удален устаревший <code>ActionView::Template#variants</code>.</p></li><li><p>  Удален устаревший <code>ActionView::Template#formats</code>.</p></li><li><p>  Удален устаревший <code>ActionView::Template#virtual_path=</code>.</p></li><li><p>  Удален устаревший <code>ActionView::Template#updated_at</code>.</p></li><li><p>  Удален устаревший аргумент <code>updated_at</code>, требуемый в <code>ActionView::Template#initialize</code>.</p></li><li><p>  Удален устаревший <code>ActionView::Template.finalize_compiled_template_methods</code>.</p></li><li><p>  Удален устаревший <code>config.action_view.finalize_compiled_template_methods</code></p></li><li><p>  Удалена устаревшая поддержка вызова <code>ActionView::ViewPaths#with_fallback</code> с блоком.</p></li><li><p>  Удалена устаревшая поддержка передачи абсолютных путей в <code>render template:</code>.</p></li><li><p>  Удалена устаревшая поддержка передачи относительных путей в <code>render file:</code>.</p></li><li><p>  Удалена поддержка обработчиков шаблона, не принимающих два аргумента.</p></li><li><p>  Удален устаревший аргумент шаблона в <code>ActionView::Template::PathResolver</code>.</p></li><li><p>  Удалена устаревшая поддержка вызова приватных методов объекта в некоторых хелперах вью.</p></li></ul><h4 id='ustarelo4' class='inside_page_header'><a href="#ustarelo4">6.2.</a> Устарело</h4><h4 id='znachimye-izmeneniya4' class='inside_page_header'><a href="#znachimye-izmeneniya4">6.3.</a> Значимые изменения</h4><ul><li><p>  Требуется, чтобы подклассы <code>ActionView::Base</code> реализовывали <code>#compiled_method_container</code>.</p></li><li><p>  Аргумент <code>locals</code> сделан обязательным в <code>ActionView::Template#initialize</code>.</p></li><li><p>  Хелперы ассетов <code>javascript_include_tag</code> и <code>stylesheet_link_tag</code> генерируют заголовок <code>Link</code>, подсказывающий современным браузерам о предварительной загрузке ассетов. Это можно отключить, установив <code>config.action_view.preload_links_header</code> в <code>false</code>.</p></li></ul><h3 id='action-mailer' class='inside_page_header'><a href="#action-mailer">7.</a> Action Mailer</h3><p>За подробностями обратитесь к <a href="https://github.com/rails/rails/blob/6-1-stable/actionmailer/CHANGELOG.md">Changelog</a>.</p><h4 id='udaleno5' class='inside_page_header'><a href="#udaleno5">7.1.</a> Удалено</h4><ul><li>  Убран устаревший <code>ActionMailer::Base.receive</code> в пользу <a href="https://github.com/rails/rails/tree/6-1-stable/actionmailbox">Action Mailbox</a>.
</li></ul><h4 id='ustarelo5' class='inside_page_header'><a href="#ustarelo5">7.2.</a> Устарело</h4><h4 id='znachimye-izmeneniya5' class='inside_page_header'><a href="#znachimye-izmeneniya5">7.3.</a> Значимые изменения</h4><h3 id='active-record' class='inside_page_header'><a href="#active-record">8.</a> Active Record</h3><p>За подробностями обратитесь к <a href="https://github.com/rails/rails/blob/6-1-stable/activerecord/CHANGELOG.md">Changelog</a>.</p><h4 id='udaleno6' class='inside_page_header'><a href="#udaleno6">8.1.</a> Удалено</h4><ul><li><p>  Удалены устаревшие методы из <code>ActiveRecord::ConnectionAdapters::DatabaseLimits</code>.</p><p><code>column_name_length</code>
<code>table_name_length</code>
<code>columns_per_table</code>
<code>indexes_per_table</code>
<code>columns_per_multicolumn_index</code>
<code>sql_query_length</code>
<code>joins_per_query</code></p></li><li><p>  Удален устаревший <code>ActiveRecord::ConnectionAdapters::AbstractAdapter#supports_multi_insert?</code>.</p></li><li><p>  Удален устаревший <code>ActiveRecord::ConnectionAdapters::AbstractAdapter#supports_foreign_keys_in_create?</code>.</p></li><li><p>  Удален устаревший <code>ActiveRecord::ConnectionAdapters::PostgreSQLAdapter#supports_ranges?</code>.</p></li><li><p>  Удалены устаревшие <code>ActiveRecord::Base#update_attributes</code> и <code>ActiveRecord::Base#update_attributes!</code>.</p></li><li><p>  Удален устаревший аргумент <code>migrations_path</code> в <code>ActiveRecord::ConnectionAdapter::SchemaStatements#assume_migrated_upto_version</code>.</p></li><li><p>  Удален устаревший <code>config.active_record.sqlite3.represent_boolean_as_integer</code>.</p></li><li><p>  Удалены устаревшие методы из <code>ActiveRecord::DatabaseConfigurations</code>.</p><p><code>fetch</code>
<code>each</code>
<code>first</code>
<code>values</code>
<code>[]=</code></p></li><li><p>  Удален устаревший метод <code>ActiveRecord::Result#to_hash</code>.</p></li><li><p>  Удалена устаревшая поддержка использования небезопасного необработанного SQL в методах <code>ActiveRecord::Relation</code>.</p></li></ul><h4 id='ustarelo6' class='inside_page_header'><a href="#ustarelo6">8.2.</a> Устарело</h4><ul><li><p>  Устарел <code>ActiveRecord::Base.allow_unsafe_raw_sql</code>.</p></li><li><p>  Устарело ключевое слово <code>database</code> в <code>connected_to</code>.</p></li><li><p>  Устарел <code>connection_handlers</code>, когда <code>legacy_connection_handling</code> установлен false.</p></li></ul><h4 id='znachimye-izmeneniya6' class='inside_page_header'><a href="#znachimye-izmeneniya6">8.3.</a> Значимые изменения</h4><ul><li><p>  MySQL: Валидатор уникальности теперь учитывает сопоставление (collation) базы данных по умолчанию, больше не принуждает к чувствительному к регистру сравнению по умолчанию.</p></li><li><p>  Из <code>relation.create</code> больше не утекает скоуп в методы запроса уровня класса в блоках инициализации и колбэках.</p><p>До:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"John"</span><span class="p">).</span><span class="nf">create</span> <span class="k">do</span> <span class="o">|</span><span class="n">john</span><span class="o">|</span>
  <span class="no">User</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"David"</span><span class="p">)</span> <span class="c1"># =&gt; nil</span>
<span class="k">end</span>
</code></pre>
</div>
<p>После:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"John"</span><span class="p">).</span><span class="nf">create</span> <span class="k">do</span> <span class="o">|</span><span class="n">john</span><span class="o">|</span>
  <span class="no">User</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"David"</span><span class="p">)</span> <span class="c1"># =&gt; #&lt;User name: "David", ...&gt;</span>
<span class="k">end</span>
</code></pre>
</div>
</li><li><p>  Из цепочки именованных скоупов больше не утекает скоуп в методы запроса уровня класса.</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">scope</span> <span class="ss">:david</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"David"</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>
<p>До:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"John"</span><span class="p">).</span><span class="nf">david</span>
<span class="c1"># SELECT * FROM users WHERE name = 'John' AND name = 'David'</span>
</code></pre>
</div>
<p>После:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"John"</span><span class="p">).</span><span class="nf">david</span>
<span class="c1"># SELECT * FROM users WHERE name = 'David'</span>
</code></pre>
</div>
</li><li><p>  <code>where.not</code> теперь генерирует предикаты NAND вместо NOR.</p><p>До:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">.</span><span class="nf">not</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"Jon"</span><span class="p">,</span> <span class="ss">role: </span><span class="s2">"admin"</span><span class="p">)</span>
<span class="c1"># SELECT * FROM users WHERE name != 'Jon' AND role != 'admin'</span>
</code></pre>
</div>
<p>После:</p><div class="code_container">
  <pre><code class="highlight ruby"><span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">.</span><span class="nf">not</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"Jon"</span><span class="p">,</span> <span class="ss">role: </span><span class="s2">"admin"</span><span class="p">)</span>
<span class="c1"># SELECT * FROM users WHERE NOT (name = 'Jon' AND role = 'admin')</span>
</code></pre>
</div>
</li><li><p>  Чтобы использовать новые соединения для отдельной базы данных, в приложении нужно изменить <code>legacy_connection_handling</code> на false и удалить устаревшие методы доступа на <code>connection_handlers</code>. Публичные методы для <code>connects_to</code> и <code>connected_to</code> менять не нужно.</p></li></ul><h3 id='active-storage' class='inside_page_header'><a href="#active-storage">9.</a> Active Storage</h3><p>За подробностями обратитесь к <a href="https://github.com/rails/rails/blob/6-1-stable/activestorage/CHANGELOG.md">Changelog</a>.</p><h4 id='udaleno7' class='inside_page_header'><a href="#udaleno7">9.1.</a> Удалено</h4><ul><li><p>  Удалена устаревшая поддержка передачи операций <code>:combine_options</code> в <code>ActiveStorage::Transformers::ImageProcessing</code>.</p></li><li><p>  Удален устаревший <code>ActiveStorage::Transformers::MiniMagickTransformer</code>.</p></li><li><p>  Удален устаревший <code>config.active_storage.queue</code>.</p></li><li><p>  Удален устаревший <code>ActiveStorage::Downloading</code>.</p></li></ul><h4 id='ustarelo7' class='inside_page_header'><a href="#ustarelo7">9.2.</a> Устарело</h4><ul><li>  Устарел <code>Blob.create_after_upload</code> в пользу <code>Blob.create_and_upload</code>.
(<a href="https://github.com/rails/rails/pull/34827">Pull Request</a>)
</li></ul><h4 id='znachimye-izmeneniya7' class='inside_page_header'><a href="#znachimye-izmeneniya7">9.3.</a> Значимые изменения</h4><ul><li><p>  Добавлен <code>Blob.create_and_upload</code> для создания нового бинарного объекта и загрузки данного <code>io</code> в сервис.
(<a href="https://github.com/rails/rails/pull/34827">Pull Request</a>)</p></li><li><p>  Был добавлен столбец <code>ActiveStorage::Blob#service_name</code>. Требуется запустить миграцию после апгрейда. Запустите <code>bin/rails app:update</code>, чтобы сгенерировать эту миграцию.</p></li></ul><h3 id='active-model' class='inside_page_header'><a href="#active-model">10.</a> Active Model</h3><p>За подробностями обратитесь к <a href="https://github.com/rails/rails/blob/6-1-stable/activemodel/CHANGELOG.md">Changelog</a>.</p><h4 id='udaleno8' class='inside_page_header'><a href="#udaleno8">10.1.</a> Удалено</h4><h4 id='ustarelo8' class='inside_page_header'><a href="#ustarelo8">10.2.</a> Устарело</h4><h4 id='znachimye-izmeneniya8' class='inside_page_header'><a href="#znachimye-izmeneniya8">10.3.</a> Значимые изменения</h4><ul><li>  Ошибки Active Model теперь объекты с интерфейсом, позволяющим вашему приложению проще обрабатывать и взаимодействовать с ошибками, выбрасываемыми моделями. <a href="https://github.com/rails/rails/pull/32313">Эта особенность</a> включает интерфейс запросов, включает более аккуратное тестирование и доступ к подробностям об ошибке.
</li></ul><h3 id='active-support' class='inside_page_header'><a href="#active-support">11.</a> Active Support</h3><p>За подробностями обратитесь к <a href="https://github.com/rails/rails/blob/6-1-stable/activesupport/CHANGELOG.md">Changelog</a>.</p><h4 id='udaleno9' class='inside_page_header'><a href="#udaleno9">11.1.</a> Удалено</h4><ul><li><p>  Удален устаревший фолбэк к <code>I18n.default_locale</code>, когда <code>config.i18n.fallbacks</code> пустой.</p></li><li><p>  Удалена устаревшая константа <code>LoggerSilence</code>.</p></li><li><p>  Удален устаревший <code>ActiveSupport::LoggerThreadSafeLevel#after_initialize</code>.</p></li><li><p>  Удалены устаревшие <code>Module#parent_name</code>, <code>Module#parent</code> и <code>Module#parents</code>.</p></li><li><p>  Удален устаревший файл <code>active_support/core_ext/module/reachable</code>.</p></li><li><p>  Удален устаревший файл <code>active_support/core_ext/numeric/inquiry</code>.</p></li><li><p>  Удален устаревший файл <code>active_support/core_ext/array/prepend_and_append</code>.</p></li><li><p>  Удален устаревший файл <code>active_support/core_ext/hash/compact</code>.</p></li><li><p>  Удален устаревший файл <code>active_support/core_ext/hash/transform_values</code>.</p></li><li><p>  Удален устаревший файл <code>active_support/core_ext/range/include_range</code>.</p></li><li><p>  Удалены устаревшие <code>ActiveSupport::Multibyte::Chars#consumes?</code> и <code>ActiveSupport::Multibyte::Chars#normalize</code>.</p></li><li><p>  Удалены устаревшие <code>ActiveSupport::Multibyte::Unicode.pack_graphemes</code>, <code>ActiveSupport::Multibyte::Unicode.unpack_graphemes</code>, <code>ActiveSupport::Multibyte::Unicode.normalize</code>, <code>ActiveSupport::Multibyte::Unicode.downcase</code>, <code>ActiveSupport::Multibyte::Unicode.upcase</code> и <code>ActiveSupport::Multibyte::Unicode.swapcase</code>.</p></li><li><p>  Удален устаревший <code>ActiveSupport::Notifications::Instrumenter#end=</code>.</p></li></ul><h4 id='ustarelo9' class='inside_page_header'><a href="#ustarelo9">11.2.</a> Устарело</h4><ul><li>  Устарел <code>ActiveSupport::Multibyte::Unicode.default_normalization_form</code>.
</li></ul><h4 id='znachimye-izmeneniya9' class='inside_page_header'><a href="#znachimye-izmeneniya9">11.3.</a> Значимые изменения</h4><h3 id='active-job' class='inside_page_header'><a href="#active-job">12.</a> Active Job</h3><p>За подробностями обратитесь к <a href="https://github.com/rails/rails/blob/6-1-stable/activejob/CHANGELOG.md">Changelog</a>.</p><h4 id='udaleno10' class='inside_page_header'><a href="#udaleno10">12.1.</a> Удалено</h4><h4 id='ustarelo10' class='inside_page_header'><a href="#ustarelo10">12.2.</a> Устарело</h4><ul><li>  Устарел <code>config.active_job.return_false_on_aborted_enqueue</code>.
</li></ul><h4 id='znachimye-izmeneniya10' class='inside_page_header'><a href="#znachimye-izmeneniya10">12.3.</a> Значимые изменения</h4><ul><li>  Возвращается <code>false</code>, когда постановка задания в очередь прерывается.
</li></ul><h3 id='action-text' class='inside_page_header'><a href="#action-text">13.</a> Action Text</h3><p>За подробностями обратитесь к <a href="https://github.com/rails/rails/blob/6-1-stable/actiontext/CHANGELOG.md">Changelog</a>.</p><h4 id='udaleno11' class='inside_page_header'><a href="#udaleno11">13.1.</a> Удалено</h4><h4 id='ustarelo11' class='inside_page_header'><a href="#ustarelo11">13.2.</a> Устарело</h4><h4 id='znachimye-izmeneniya11' class='inside_page_header'><a href="#znachimye-izmeneniya11">13.3.</a> Значимые изменения</h4><ul><li><p>  Добавлен метод для подтверждения существования обогащенного текста, добавляя <code>?</code> после имени атрибута обогащенного текста.
(<a href="https://github.com/rails/rails/pull/37951">Pull Request</a>)</p></li><li><p>  Добавлен системный тестовый хелпер <code>fill_in_rich_text_area</code> для поиска редактора trix и его заполнения заданным содержимым HTML.
(<a href="https://github.com/rails/rails/pull/35885">Pull Request</a>)</p></li><li><p>  Добавлен <code>ActionText::FixtureSet.attachment</code> для генерации элементов <code>&lt;action-text-attachment&gt;</code> в фикстурах базы данных.
(<a href="https://github.com/rails/rails/pull/40289">Pull Request</a>)</p></li></ul><h3 id='action-mailbox' class='inside_page_header'><a href="#action-mailbox">14.</a> Action Mailbox</h3><p>За подробностями обратитесь к <a href="https://github.com/rails/rails/blob/6-1-stable/actionmailbox/CHANGELOG.md">Changelog</a>.</p><h4 id='udaleno12' class='inside_page_header'><a href="#udaleno12">14.1.</a> Удалено</h4><h4 id='ustarelo12' class='inside_page_header'><a href="#ustarelo12">14.2.</a> Устарело</h4><ul><li>  Устарели <code>Rails.application.credentials.action_mailbox.api_key</code> и <code>MAILGUN_INGRESS_API_KEY</code> в пользу <code>Rails.application.credentials.action_mailbox.signing_key</code> и <code>MAILGUN_INGRESS_SIGNING_KEY</code>.
</li></ul><h4 id='znachimye-izmeneniya12' class='inside_page_header'><a href="#znachimye-izmeneniya12">14.3.</a> Значимые изменения</h4><h3 id='ruby-on-rails-guides' class='inside_page_header'><a href="#ruby-on-rails-guides">15.</a> Ruby on Rails Guides</h3><p>За подробностями обратитесь к <a href="https://github.com/rails/rails/blob/6-1-stable/guides/CHANGELOG.md">Changelog</a>.</p><h4 id='znachimye-izmeneniya13' class='inside_page_header'><a href="#znachimye-izmeneniya13">15.1.</a> Значимые изменения</h4><h3 id='blagodarnosti' class='inside_page_header'><a href="#blagodarnosti">16.</a> Благодарности</h3><p>Взгляните <a href="http://contributors.rubyonrails.org/">на полный список контрибьюторов Rails</a>, на людей, которые потратили много часов, сделав Rails стабильнее и надёжнее. Спасибо им всем.</p>

            <div class="banner">
              <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

   <!-- bottom rusrails -->
   <ins class="adsbygoogle"
        style="display:inline-block;width:580px;height:400px"
        data-ad-client="ca-pub-7764391801669990"
        data-ad-slot="7566253867"></ins>


<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

            </div>
          </div>
        </div>
        <div class="row-fluid">
          <div class="span12" id="footer">
            <p>
              <a target="blank" href="https://github.com/rusrails/rusrails"><img src="/assets/github-7cc23602a5ac2465f14c19492358a5a67dc24636761cc723e4d621cea0c09225.png" /></a>
              <a target="blank" href="http://twitter.com/rusrails"><img src="/assets/twitter-50e0e767c8793dec313a7dc5cfbcfe2067e3e89ea6ec64784eb7c6640f578758.png" /></a>
            </p>
            <p>
              <a href="https://creativecommons.org/licenses/by-sa/4.0/">Лицензия CC BY-SA 4.0</a>
              "Rails", "Ruby on Rails" и логотип Rails - торговые марки DHH
              <!-- Yandex.Metrika counter -->
<script>
  (function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter1006929 = new Ya.Metrika({id:1006929,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>

<noscript>
  <div>
    <img style="position:absolute; left:-9999px;" alt="" src="//mc.yandex.ru/watch/1006929" />
  </div>
</noscript>
<!-- /Yandex.Metrika counter -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-64955373-1', 'auto');
  ga('send', 'pageview');

  var trackOutboundLink = function(url) {
    ga('send', 'event', 'outbound', 'click', url, {
      'transport': 'beacon',
      'hitCallback': function(){ }
    });
  }
</script>

            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="to_top" style="display: block">
      <div class="to_top_panel"></div>
    </div>
    <script src="/assets/application-8ee447905888b153d8458707061a14b1f15f69b6733e871a3ad91d80ae89e87b.js"></script>
  </body>
</html>
